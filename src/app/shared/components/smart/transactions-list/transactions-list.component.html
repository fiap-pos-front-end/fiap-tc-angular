@if (transactions$ | async; as transactions) {
  <div class="card">
    <p-toast />

    <app-transactions-list-header-toolbar
      [selectedTransactions]="selectedTransactions"
      (onNewTransactionClicked)="onNewTransactionClicked()"
      (onDeleteSelectedTransactionsClicked)="deleteMultipleTransactions()"
      (onExportCsvClicked)="onExportCsvClicked()"
    />

    <p-table
      #dt
      [value]="transactions"
      [rows]="10"
      [columns]="cols"
      [paginator]="true"
      [globalFilterFields]="['type', 'amount', 'date', 'category']"
      [tableStyle]="{ 'min-width': '75rem' }"
      [(selection)]="selectedTransactions"
      [rowHover]="true"
      dataKey="id"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} transações"
      [showCurrentPageReport]="true"
    >
      <ng-template #header>
        <tr>
          <th style="width: 3rem">
            <p-tableHeaderCheckbox />
          </th>
          <th style="min-width: 3rem">#</th>
          <th pSortableColumn="type" style="min-width: 10rem">
            <div class="flex gap-2 items-center">
              Tipo
              <p-sortIcon field="type" />
            </div>
          </th>
          <th pSortableColumn="amount" style="min-width: 10rem">
            <div class="flex gap-2 items-center">
              Valor
              <p-sortIcon field="amount" />
            </div>
          </th>
          <th pSortableColumn="category" style="min-width: 10rem">
            <div class="flex gap-2 items-center">
              Categoria
              <p-sortIcon field="category" />
            </div>
          </th>
          <th pSortableColumn="date" style="min-width: 12rem">
            <div class="flex gap-2 items-center">
              Data
              <p-sortIcon field="date" />
            </div>
          </th>
          <th style="min-width: 12rem"></th>
        </tr>
      </ng-template>
      <ng-template #body let-transaction>
        <tr>
          <td style="width: 3rem">
            <p-tableCheckbox [value]="transaction" />
          </td>
          <td style="min-width: 3rem">{{ transaction.id }}</td>
          <td>
            <p-tag [value]="transaction.type" [severity]="getTransactionTypeColor(transaction.type)" />
          </td>
          <td>{{ transaction.amount.toString() }}</td>
          <td>{{ transaction.category | titlecase }}</td>
          <td>{{ transaction.date | date: 'dd/MM/yyyy HH:mm' }}</td>
          <td>
            <p-button
              icon="pi pi-pencil"
              class="mr-2"
              [rounded]="true"
              [outlined]="true"
              (click)="editTransaction(transaction)"
            />
            <p-button
              icon="pi pi-trash"
              severity="danger"
              [rounded]="true"
              [outlined]="true"
              (click)="deleteTransaction(transaction)"
            />
          </td>
        </tr>
      </ng-template>
    </p-table>

    <p-dialog [(visible)]="newTransactionDialog" [style]="{ width: '450px' }" header="Nova transação" [modal]="true">
      <app-transaction-form />
    </p-dialog>

    <p-confirmDialog [style]="{ width: '450px' }" />
  </div>
}
